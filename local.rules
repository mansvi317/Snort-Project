# $Id: local.rules,v 1.11 2004/07/23 20:15:44 bmc Exp $
# ----------------
# LOCAL RULES
# ----------------
# This file intentionally does not come with signatures.  Put your local
# additions here.

# Test rule (alerts on any packet)
#alert ip any any -> any any (msg:"TEST ALERT"; sid:1; rev:1;)

# C2 traffic
alert tcp any any -> any any (msg:"C2 Traffic to duckdns.org"; content:"duckdns.org"; nocase; sid:100001; rev:1;)
alert tcp any any -> any any (msg:"PowerShell execution string in traffic"; content:"powershell.exe"; nocase; sid:100004; rev:1;)

# Data exfiltration
alert tcp any any -> any any (msg:"Suspicious exfiltration - password file"; content:"password file.txt"; nocase; sid:100002; rev:1;)
alert tcp any any -> any any (msg:"Suspicious exfiltration - Invoice.docx"; content:"Invoice.docx"; nocase; sid:100003; rev:1;)
alert tcp any any -> any any (msg:"Suspicious exfiltration of Edge Login Data"; content:"Login Data"; nocase; sid:2000002; rev:1;)
alert tcp any any -> any any (msg:"Exfiltrated Gmail credentials"; content:"imap.gmail.com"; nocase; sid:2000004; rev:1;)

# Malware / tools
alert tcp any any -> any any (msg:"Mail PassView credential theft tool detected"; content:"Mail PassView"; nocase; sid:2000003; rev:1;)

# PE file transfers
alert tcp any any -> any any (msg:"Suspicious PE file transfer"; content:"MZ"; sid:2000001; rev:2;)

alert tcp any any -> any any (msg:"Suspicious GeoIP lookup - geoplugin.net"; content:"Host|3a| geoplugin.net"; http_header; nocase; sid:300010; rev:1;)

# Detect Thunderbird credential exfiltration
alert tcp any any -> any any (msg:"Credential Theft - Thunderbird Email Dump"; content:"Thunderbird"; nocase; sid:500001; rev:1;)

# Detect Outlook credential exfiltration
alert tcp any any -> any any (msg:"Credential Theft - Outlook Email Dump"; content:"Outlook"; nocase; sid:500002; rev:1;)

# Detect suspicious Gmail IMAP credentials
alert tcp any any -> any any (msg:"Credential Theft - Gmail IMAP Credentials"; content:"imap.gmail.com"; nocase; sid:500003; rev:1;)

# Detect suspicious Gmail SMTP credentials
alert tcp any any -> any any (msg:"Credential Theft - Gmail SMTP Credentials"; content:"smtp.gmail.com"; nocase; sid:500004; rev:1;)

# Detect presence of 'Password Strength' field in traffic
alert tcp any any -> any any (msg:"Credential Theft - Password Strength Exfiltration"; content:"Password Strength"; nocase; sid:500005; rev:1;)

# Detect dumps containing 'Application :' field (common in credential stealers)
alert tcp any any -> any any (msg:"Credential Theft - Application Credential Dump"; content:"Application       :"; nocase; sid:500006; rev:1;)